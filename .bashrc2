# ===================================================================
#                ğŸ˜„ğŸ˜„ğŸ˜„ Bash Configuration ğŸ˜„ğŸ˜„ğŸ˜„                  =
# ===================================================================
#
#  è¯´æ˜:
#  è¿™æ˜¯ä¸€ä¸ªä¸“ä¸º Bash ç¯å¢ƒä¼˜åŒ–çš„é…ç½®æ–‡ä»¶ã€‚
#  è¯·æ ¹æ®æ‚¨è‡ªå·±çš„éœ€æ±‚ï¼Œä¿®æ”¹ä¸‹é¢çš„ "åŸºç¡€é…ç½®" éƒ¨åˆ†ã€‚
#

# ======================================
# ======== âš™ï¸ åŸºç¡€é…ç½® (è¯·ä¿®æ”¹) âš™ï¸ ========
# ======================================
# 1. é…ç½®ä½ å­˜æ”¾æ‰€æœ‰ Git ä»“åº“çš„æ ¹æ–‡ä»¶å¤¹è·¯å¾„
# ä¾‹å¦‚: export git_lib="/c/Users/your_name/repositories"

# 2. é…ç½®ä½ çš„ Git ç”¨æˆ·å (ç”¨äºæ‹¼æ¥ GitHub/Gitee çš„è¿œç¨‹åœ°å€)
# ä¾‹å¦‚: export username="Leivmox"
# ä¾‹å¦‚: export username="Leivmox"

# 3. (å¯é€‰) é…ç½®ä¸€äº›å¸¸ç”¨ Git ä»“åº“çš„ç®€å†™, æ–¹ä¾¿ä½¿ç”¨ gr å‘½ä»¤å¿«é€Ÿè·³è½¬
# æ ¼å¼: export ç®€å†™="ä»“åº“æ–‡ä»¶å¤¹å"
# ä¾‹å¦‚:
# export py="Python"
# export code="code_2023"
# export web="JavaWeb"

# ======================================
# ======== ğŸ˜„ğŸ˜„ğŸ˜„ Base ğŸ˜„ğŸ˜„ğŸ˜„ =========
# ======================================

# --- å¿«æ·åˆ«å ---
alias ..="cd ../"
alias ll='ls -lh --color=auto --group-directories-first'
alias la='ls -lah --color=auto --group-directories-first'
alias mv='mv -i -v'
alias cp='cp -i -v'
alias :q='exit'
alias :wq='exit'

# --- Screen å·¥å…·åˆ«å ---
alias scs='screen -S'   # åˆ›å»ºä¼šè¯
alias scr='screen -r'   # æ¢å¤ä¼šè¯
alias scls='screen -ls' # åˆ—å‡ºæ‰€æœ‰ä¼šè¯
alias scx='screen -x'   # è¿æ¥åˆ°å·²å­˜åœ¨ä¼šè¯
alias sck='screen -X quit' # å¼ºåˆ¶ç»ˆæ­¢å½“å‰ä¼šè¯

# --- ç³»ç»Ÿä¸é…ç½®ç¼–è¾‘åˆ«å ---
alias neo='neofetch'
alias vimzsh='vim ~/.zshrc'
alias vimbash='vim ~/.bashrc'
alias vimrc='vim ~/.vimrc'
123123
# --- é¢œè‰²å®šä¹‰ (å…¨å±€å˜é‡) ---
RED='\033[0;31m'    # çº¢è‰²
GREEN='\033[0;32m'  # ç»¿è‰²
YELLOW='\033[0;33m' # é»„è‰²
BLUE='\033[0;34m'   # è“è‰²
PURPLE='\033[0;35m' # ç´«è‰²
BOLD='\033[1m'      # åŠ ç²—
NC='\033[0m'        # é‡ç½®é¢œè‰²

# ======================================
# ======== ğŸ› ï¸ ç¼–è¯‘ä¸è¿è¡Œ ğŸ› ï¸ ==========
# ======================================
# åˆ›å»º out æ–‡ä»¶å¤¹, ç¼–è¯‘ C ä»£ç å¹¶è¿è¡Œ
gcco() {
    if [ -z "$1" ]; then echo "é”™è¯¯: æœªæä¾› C æºæ–‡ä»¶!"; return 1; fi
    if ! command -v gcc &>/dev/null; then echo "é”™è¯¯: gcc æœªå®‰è£…!"; return 1; fi
    if [ ! -f "$1" ]; then echo "é”™è¯¯: æºæ–‡ä»¶ '$1' ä¸å­˜åœ¨!"; return 1; fi
    mkdir -p out || { echo "é”™è¯¯: æ— æ³•åˆ›å»º 'out' ç›®å½•ã€‚"; return 1; }
    command gcc "$1" -o out/"${1%.*}" || { echo "é”™è¯¯: ç¼–è¯‘å¤±è´¥ã€‚"; return 1; }
    echo ">>> æ­£åœ¨è¿è¡Œ out/${1%.*} ..."
    ./out/"${1%.*}" || { echo "é”™è¯¯: è¿è¡Œå¤±è´¥ã€‚"; return 1; }
}

# åˆ›å»º out æ–‡ä»¶å¤¹, ç¼–è¯‘ C++ ä»£ç å¹¶è¿è¡Œ
cppo() {
    if [ -z "$1" ]; then echo "é”™è¯¯: æœªæä¾› C++ æºæ–‡ä»¶!"; return 1; fi
    if ! command -v g++ &>/dev/null; then echo "é”™è¯¯: g++ æœªå®‰è£…!"; return 1; fi
    if [ ! -f "$1" ]; then echo "é”™è¯¯: æºæ–‡ä»¶ '$1' ä¸å­˜åœ¨!"; return 1; fi
    mkdir -p out || { echo "é”™è¯¯: æ— æ³•åˆ›å»º 'out' ç›®å½•ã€‚"; return 1; }
    command g++ "$1" -o out/"${1%.*}" || { echo "é”™è¯¯: ç¼–è¯‘å¤±è´¥ã€‚"; return 1; }
    echo ">>> ç¼–è¯‘æˆåŠŸ! å¯æ‰§è¡Œæ–‡ä»¶ä½äº out/${1%.*}"
    echo ">>> æ­£åœ¨è¿è¡Œ out/${1%.*} ..."
    ./out/"${1%.*}" || { echo "é”™è¯¯: è¿è¡Œå¤±è´¥ã€‚"; return 1; }
}

# ======================================
# ======== ğŸš€ğŸš€ğŸš€ Git ğŸš€ğŸš€ğŸš€ ==========
# ======================================

# --- Git åŸºç¡€åˆ«å ---
alias gaa='git add .'
alias gpl='git pull'
alias gph="git push"
alias gcm='gc' # gc æ˜¯ä¸‹é¢çš„å‡½æ•°
alias gplall="gr && execute_gpl_and_ginfo_in_folders"
alias gacpall="gr && execute_gpl_gacp_in_folders" # <-- å·²æ›´æ–°
alias gitall='gacpall'
alias gall='gacpall'

# --- æ£€æŸ¥å½“å‰ç›®å½•æ˜¯å¦ä¸º Git ä»“åº“çš„é€šç”¨å‡½æ•° ---
check_git_repo() {
    if ! git rev-parse --is-inside-work-tree &>/dev/null; then
        echo -e "${RED}é”™è¯¯: å½“å‰ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ Git ä»“åº“ã€‚${NC}"
        return 1
    fi
    return 0
}

# --- ç®€åŒ– commit å‘½ä»¤ ---
# ç”¨æ³•: gc "ä½ çš„æäº¤ä¿¡æ¯"
function gc() {
    if [ -z "$1" ]; then
        echo "é”™è¯¯: è¯·æä¾›æäº¤ä¿¡æ¯ã€‚"
        return 1
    fi
    check_git_repo || return 1
    git commit -m "$1" || return 1
    echo ">>> æäº¤æˆåŠŸ: $1 <<<"
}

# --- ä¸€é”®æ¨é€ (add -> commit -> push) ---
# è‡ªåŠ¨ add æ‰€æœ‰æ–‡ä»¶, å¹¶ä»¥ "update" ä½œä¸º commit message, ç„¶åæ¨é€åˆ°è¿œç¨‹
function gacp() {
    check_git_repo || return 1

    git add . || {
        echo -e "${RED}é”™è¯¯: æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒºå¤±è´¥ã€‚${NC}"
        return 1
    }

    # æ£€æŸ¥æ˜¯å¦æœ‰éœ€è¦æäº¤çš„æ›´æ”¹
    if git diff-index --quiet HEAD --; then
        echo -e "${GREEN}å·¥ä½œåŒºå¹²å‡€, æ— éœ€æäº¤ã€‚${NC}"
    else
        git commit -m "update" || {
            echo -e "${RED}é”™è¯¯: æäº¤æ›´æ”¹å¤±è´¥ã€‚${NC}"
            return 1
        }
    fi

    # æ¨é€åˆ° Gitee å’Œ GitHub
    apush || {
        echo -e "${RED}é”™è¯¯: æ¨é€åˆ°è¿œç¨‹ä»“åº“å¤±è´¥ã€‚${NC}"
        return 1
    }
}

# --- åŒæ—¶æ¨é€åˆ° Gitee å’Œ GitHub ---
# apush = All Push
function apush() {
    check_git_repo || return 1

    local folder_name=$(basename "$(pwd)")
    local current_branch=$(git rev-parse --abbrev-ref HEAD)
    if [[ $? -ne 0 ]]; then
        echo -e "${RED}é”™è¯¯: è·å–å½“å‰åˆ†æ”¯å¤±è´¥ã€‚${NC}"
        return 1
    fi

    echo -e "${YELLOW}>>> å‡†å¤‡æ¨é€å½“å‰åˆ†æ”¯: ${GREEN}${current_branch}${NC} <<<"

    local gitee_status=0
    local github_status=0

    # æ¨é€åˆ° Gitee
    echo -e "${YELLOW}>>> æ­£åœ¨æ¨é€åˆ° Gitee...${NC}"
    git remote set-url origin "git@gitee.com:${username}/${folder_name}.git" && git push origin "${current_branch}"
    if [[ $? -ne 0 ]]; then
        echo -e "${RED}Gitee æ¨é€å¤±è´¥ã€‚${NC}"; gitee_status=1
    else
        echo -e "${GREEN}>>> Gitee æ¨é€æˆåŠŸ! <<<${NC}"
    fi

    echo "" # æ·»åŠ ç©ºè¡Œä»¥åˆ†éš”

    # æ¨é€åˆ° GitHub
    echo -e "${YELLOW}>>> æ­£åœ¨æ¨é€åˆ° GitHub...${NC}"
    git remote set-url origin "git@github.com:${username}/${folder_name}.git" && git push origin "${current_branch}"
    if [[ $? -ne 0 ]]; then
        echo -e "${RED}GitHub æ¨é€å¤±è´¥ã€‚${NC}"; github_status=1
    else
        echo -e "${GREEN}>>> GitHub æ¨é€æˆåŠŸ! <<<${NC}"
    fi

    # æœ€ç»ˆç»“æœæŠ¥å‘Š
    if [ $gitee_status -eq 1 ] && [ $github_status -eq 1 ]; then
        echo -e "\n${RED}>>> Gitee å’Œ GitHub æ¨é€å‡å¤±è´¥! <<<${NC}"; return 1
    elif [ $gitee_status -eq 1 ]; then
        echo -e "\n${YELLOW}>>> Gitee æ¨é€å¤±è´¥, ä½† GitHub æ¨é€æˆåŠŸ! <<<${NC}"
    elif [ $github_status -eq 1 ]; then
        echo -e "\n${YELLOW}>>> GitHub æ¨é€å¤±è´¥, ä½† Gitee æ¨é€æˆåŠŸ! <<<${NC}"
    else
        echo -e "\n${GREEN}>>> å·²æˆåŠŸæ¨é€åˆ° Gitee å’Œ GitHub! <<<${NC}"
    fi
    return 0
}


# --- å¿«é€Ÿåˆ‡æ¢è¿œç¨‹ä»“åº“åœ°å€ ---
function gitee() {
    check_git_repo || return 1
    local folder_name=$(basename "$(pwd)")
    git remote set-url origin "git@gitee.com:${username}/${folder_name}.git" || return 1
    echo -e "${GREEN}>>> å·²åˆ‡æ¢åˆ° Gitee ä»“åº“: ${BLUE}(${folder_name})${NC} <<<"
}

function github() {
    check_git_repo || return 1
    local folder_name=$(basename "$(pwd)")
    git remote set-url origin "git@github.com:${username}/${folder_name}.git" || return 1
    echo -e "${GREEN}>>> å·²åˆ‡æ¢åˆ° GitHub ä»“åº“: ${BLUE}(${folder_name})${NC} <<<"
}


# --- è¿›å…¥æŒ‡å®šä»“åº“ç›®å½• (Go Repository) ---
# ç”¨æ³•:
# gr        -> è¿›å…¥ git_lib æ ¹ç›®å½•
# gr py     -> è¿›å…¥ git_lib/Python ç›®å½• (ä½¿ç”¨äº†ä¸Šé¢é…ç½®çš„ç®€å†™)
# gr my-repo -> è¿›å…¥ git_lib/my-repo ç›®å½• (å¦‚æœæœªé…ç½®ç®€å†™)
function gr() {
    # å¦‚æœæ²¡æœ‰å‚æ•°, ç›´æ¥è¿›å…¥ git_lib æ ¹ç›®å½•
    if [ -z "$1" ]; then
        cd "$git_lib" || {
            echo -e "${RED}é”™è¯¯: æ— æ³•è®¿é—®ç›®å½• ${git_lib}ã€‚${NC}"; return 1
        }
        echo -e "${GREEN}>>> å·²åˆ‡æ¢åˆ°æ ¹ç›®å½•: (${git_lib}) <<<${NC}"
        return 0
    fi

    local repo_short_name=$1
    # BASH-NATIVE: ä½¿ç”¨ Bash çš„ ${!} è¯­æ³•è¿›è¡Œé—´æ¥å˜é‡å¼•ç”¨
    local repo_name=${!repo_short_name}

    # å¦‚æœç®€å†™æœªå®šä¹‰, åˆ™å°†å‚æ•°æœ¬èº«ä½œä¸ºç›®æ ‡æ–‡ä»¶å¤¹å
    if [ -z "$repo_name" ]; then
        repo_name=$repo_short_name
    fi

    local target_dir="${git_lib}/${repo_name}"

    # åˆ‡æ¢åˆ°ç›®æ ‡ç›®å½•
    cd "$target_dir" || {
        echo -e "${RED}é”™è¯¯: æ— æ³•è®¿é—®ç›®å½• ${target_dir}ã€‚${NC}"; return 1
    }

    # è‡ªåŠ¨è®¾ç½®è¿œç¨‹ä»“åº“ä¸º GitHub
    git remote set-url origin "git@github.com:${username}/${repo_name}.git" &>/dev/null
    echo -e "${GREEN}>>> å·²åˆ‡æ¢åˆ°ä»“åº“: (${repo_name}) <<<${NC}"
}

# --- æ˜¾ç¤ºå½“å‰ä»“åº“çš„è¯¦ç»†çŠ¶æ€ä¿¡æ¯ (Git Info) ---
function ginfo() {
    check_git_repo || return 0 # å³ä½¿ä¸æ˜¯gitä»“åº“ä¹Ÿç»§ç»­æ‰§è¡Œï¼Œåªæ˜¯éƒ¨åˆ†ä¿¡æ¯ä¼šæŠ¥é”™
    local folder_name=$(basename "$(pwd)")

    echo -e "${BLUE}===========================================${NC}"
    echo -e "${YELLOW}>>> è·¯å¾„: ${NC}$(pwd)"
    echo -e "${YELLOW}>>> è¿œç¨‹ä»“åº“: ${NC}"
    git remote -v || echo -e "${RED}ä¸æ˜¯ä¸€ä¸ª Git ä»“åº“ã€‚${NC}"
    echo -e "${YELLOW}>>> å½“å‰åˆ†æ”¯: ${NC}${GREEN}$(git rev-parse --abbrev-ref HEAD 2>/dev/null || echo '-')${NC}"
    echo -e "${YELLOW}>>> æœ€åæäº¤: ${NC}${GREEN}$(git log -1 --pretty=format:'%h | %an | %s' 2>/dev/null || echo '-')${NC}"
    echo -e "${YELLOW}>>> ç”¨æˆ·é…ç½®: ${NC}"
    git config --list --show-origin | grep -E 'user.name|user.email' || echo -e "${RED}æ— æ³•è·å– Git ç”¨æˆ·é…ç½®ã€‚${NC}"
    echo -e "${YELLOW}>>> ç³»ç»Ÿä¿¡æ¯: ${NC}${GREEN}OS: $(uname -o) $(uname -r) | Shell: Bash $BASH_VERSION${NC}" # <-- BASH
    echo -e "${YELLOW}>>> ç¯å¢ƒå˜é‡ 'username': ${NC}${GREEN}${username:-'æœªå®šä¹‰'}${NC}"
    echo -e "${YELLOW}>>> ä»“åº“çŠ¶æ€: ${NC}"
    if [ -n "$(git status -s)" ]; then
        echo -e "${RED}æœ‰æœªæäº¤çš„æ›´æ”¹:${NC}"
        git status -s
    else
        echo -e "${GREEN}å·¥ä½œåŒºå¹²å‡€ã€‚${NC}"
    fi
    echo -e "${BLUE}===========================================${NC}"
}


# ======================================
# ======== ğŸ“¦ æ‰¹é‡æ“ä½œå‡½æ•° ğŸ“¦ ========
# ======================================

# --- æ‰¹é‡åœ¨æ‰€æœ‰å­ç›®å½•æ‰§è¡Œ git pull å’Œ ginfo ---
function execute_gpl_and_ginfo_in_folders() {
    local failed_folders=()
    for folder in */; do
        if [ -d "$folder" ]; then
            echo -e "\n${YELLOW}>>> è¿›å…¥: ${BOLD}${BLUE}${folder}${NC} <<<"
            (
                cd "$folder" && \
                echo -e "${YELLOW}--- æ­£åœ¨æ‰§è¡Œ gpl ---${NC}" && \
                gpl && \
                echo -e "${YELLOW}--- æ­£åœ¨æ‰§è¡Œ ginfo ---${NC}" && \
                ginfo
            ) || failed_folders+=("$folder")
        fi
    done

    if [ ${#failed_folders[@]} -gt 0 ]; then
        echo -e "\n${RED}==========================================="
        echo "ä»¥ä¸‹ç›®å½•æ‰§è¡Œ gpl å¤±è´¥:"
        for folder in "${failed_folders[@]}"; do
            echo "- $folder"
        done
        echo -e "===========================================${NC}"
    else
        echo -e "\n${GREEN}>>> æ‰€æœ‰ç›®å½• gpl æ‰§è¡ŒæˆåŠŸ! <<<${NC}"
    fi
}

# --- æ‰¹é‡åœ¨æ‰€æœ‰å­ç›®å½•æ‰§è¡Œ git pull, gacp ---
function execute_gpl_gacp_in_folders() { # <-- å·²é‡å‘½å
    local gpl_failed=()
    local gacp_failed=()

    for folder in */; do
        if [ -d "$folder" ]; then
            echo -e "\n${YELLOW}>>> è¿›å…¥: ${BOLD}${BLUE}${folder}${NC} <<<"
            cd "$folder" || {
                gpl_failed+=("$folder")
                continue
            }

            echo -e "${YELLOW}--- æ­£åœ¨æ‰§è¡Œ gpl ---${NC}"
            if ! gpl; then
                echo -e "${RED}gpl å¤±è´¥, è·³è¿‡ gacpã€‚${NC}"
                gpl_failed+=("$folder")
                cd ..
                continue
            fi

            echo -e "${YELLOW}--- æ­£åœ¨æ‰§è¡Œ gacp ---${NC}"
            if ! gacp; then
                gacp_failed+=("$folder")
                echo -e "${YELLOW}gacp å¤±è´¥, æ˜¾ç¤ºå½“å‰ä»“åº“ä¿¡æ¯ä»¥ä¾›è°ƒè¯•:${NC}"
                ginfo # å¦‚æœ gacp å¤±è´¥, è°ƒç”¨ ginfo å¸®åŠ©æ’æŸ¥é—®é¢˜
            fi
            cd ..
        fi
    done

    # æ±‡æ€»æŠ¥å‘Š
    if [ ${#gpl_failed[@]} -eq 0 ]; then
        echo -e "\n${GREEN}>>> æ‰€æœ‰ç›®å½• gpl æ‰§è¡ŒæˆåŠŸ! <<<${NC}"
    else
        echo -e "\n${RED}--- gpl å¤±è´¥ç›®å½• ---"
        for folder in "${gpl_failed[@]}"; do
            echo "- $folder"
        done
    fi
    
    if [ ${#gacp_failed[@]} -eq 0 ]; then
        echo -e "\n${GREEN}>>> æ‰€æœ‰ç›®å½• gacp æ‰§è¡ŒæˆåŠŸ! <<<${NC}"
        echo -e "
${BLUE}
â¡‡â¢¸â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â££â „â¡€â¢¬â£­â£»â£·â¡Œâ¢¿â£¿â£¿
â¡€â ˆâ£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£§â ˆâ£†â¢¹â£¿â£¿â£¿â¡ˆâ¢¿â£¿
â¡‡â „â¢›â£›â£»â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡†â ¹â£¿â£†â ¸â£†â ™â ›â ›â ƒâ ˜â£¿
â£¡â „â¡ˆâ£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â ¿â Ÿâ â£ â£‰â£¤â£´â£¿â£¿â ¿â ¿â ¿â¡‡â¢¸
â¢¿â£†â °â¡˜â¢¿â£¿â ¿â¢›â£‰â£¥â£´â£¶â£¿â£¿â£¿â£¿â£»â Ÿâ£‰â£¤â£¶â£¶â£¾â£¿â¡„
â ¸â£¿â „â¢³â£ â£¤â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£§â£¼â£¿â£¿â£¿â£¿â£¿â£¿â¡‡
â¢£â£¡â£¶â ¿â Ÿâ ›â “â£šâ£»â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£‡
â „â »â£§â£´â£¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â Ÿâ ›â ›â ›â¢¿â£¿â£¿â£¿â£¿â£¿â¡Ÿ
â£·â¡€â ˜â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡‹â¢€â£ â£¤â£¶â£¶â£¾â¡†â£¿â£¿â£¿â Ÿâ 
â¡˜â£¿â¡€â¢»â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£§â ¸â£¿â£¿â£¿â£¿â£¿â£·â¡¿â Ÿâ ‰â „â „
â£·â¡ˆâ¢·â¡€â ™â ›â »â ¿â ¿â ¿â ¿â ¿â ·â ¾â ¿â Ÿâ£›â£‹â£¥â£¶â£„â „â¢€â£„
${NC}
"
    else
        echo -e "\n${RED}--- gacp å¤±è´¥ç›®å½• ---"
        for folder in "${gacp_failed[@]}"; do
            echo "- $folder"
        done
    fi
}